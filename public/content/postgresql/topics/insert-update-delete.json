{
  "id": "insert-update-delete",
  "title": "INSERT, UPDATE, DELETE",
  "description": "Modify data in database tables - add, update, or remove records.",
  "code": "-- CANONICAL E-COMMERCE SCHEMA\nCREATE TABLE users (\n  id SERIAL PRIMARY KEY,\n  first_name VARCHAR(100) NOT NULL,\n  last_name VARCHAR(100) NOT NULL,\n  email VARCHAR(255) UNIQUE NOT NULL,\n  role VARCHAR(20) NOT NULL DEFAULT 'customer',\n  created_at TIMESTAMP DEFAULT NOW(),\n  updated_at TIMESTAMP DEFAULT NOW()\n);\n\nCREATE TABLE products (\n  id SERIAL PRIMARY KEY,\n  name VARCHAR(255) NOT NULL,\n  sku VARCHAR(100) UNIQUE NOT NULL,\n  price DECIMAL(10,2) NOT NULL,\n  stock_quantity INT NOT NULL DEFAULT 0,\n  category VARCHAR(100),\n  image_url TEXT,\n  created_at TIMESTAMP DEFAULT NOW(),\n  updated_at TIMESTAMP DEFAULT NOW()\n);\n\nCREATE TABLE orders (\n  id SERIAL PRIMARY KEY,\n  order_number VARCHAR(50) UNIQUE NOT NULL,\n  user_id INT NOT NULL REFERENCES users(id),\n  total_amount DECIMAL(10,2) NOT NULL,\n  status VARCHAR(20) NOT NULL,\n  payment_method VARCHAR(20),\n  shipping_address JSONB,\n  billing_address JSONB,\n  created_at TIMESTAMP DEFAULT NOW(),\n  updated_at TIMESTAMP DEFAULT NOW()\n);\n\nCREATE TABLE order_items (\n  id SERIAL PRIMARY KEY,\n  order_id INT NOT NULL REFERENCES orders(id),\n  product_id INT NOT NULL REFERENCES products(id),\n  quantity INT NOT NULL,\n  price_at_time DECIMAL(10,2) NOT NULL\n);\n\nCREATE TABLE payments (\n  id SERIAL PRIMARY KEY,\n  order_id INT NOT NULL REFERENCES orders(id),\n  amount DECIMAL(10,2) NOT NULL,\n  payment_method VARCHAR(20) NOT NULL,\n  status VARCHAR(20) NOT NULL,\n  transaction_id VARCHAR(100),\n  created_at TIMESTAMP DEFAULT NOW()\n);\n\n-- INSERT single row\nINSERT INTO users (first_name, last_name, email) \nVALUES ('John', 'Doe', 'john@example.com');\n\n-- INSERT multiple rows\nINSERT INTO products (name, sku, price, stock_quantity, category) \nVALUES \n  ('Product A', 'SKU-A', 99.99, 50, 'Electronics'),\n  ('Product B', 'SKU-B', 149.99, 30, 'Electronics'),\n  ('Product C', 'SKU-C', 79.99, 100, 'Books');\n\n-- UPDATE\nUPDATE users \nSET first_name = 'Jane', updated_at = NOW() \nWHERE id = 1;\n\n-- DELETE\nDELETE FROM orders \nWHERE status = 'cancelled' AND created_at < NOW() - INTERVAL '30 days';\n\n-- RETURNING clause\nINSERT INTO users (first_name, last_name, email) \nVALUES ('Jane', 'Smith', 'jane@example.com') \nRETURNING id, created_at;",
  "example": "-- UPDATE with subquery\nUPDATE products \nSET category_id = (\n  SELECT id FROM categories WHERE name = 'Electronics'\n)\nWHERE name LIKE '%Phone%';\n\n-- DELETE with JOIN\nDELETE FROM order_items \nWHERE order_id IN (\n  SELECT id FROM orders WHERE status = 'cancelled'\n);\n\n-- INSERT from SELECT\nINSERT INTO archived_users \nSELECT * FROM users \nWHERE last_login < NOW() - INTERVAL '1 year';",
  "useCase": "Data manipulation, CRUD operations, bulk updates, archiving",
  "category": "Basic Queries"
}
